# Ver 1.0

# Abstract

We go beyond the quasi-static approximation and precisely simulate the surface acoustic wave on a piezoelectric material.

# Introduction

Surface acoustic waves (SAW) are acoustic waves propagating along the surface of media. When these media are piezoelectric, SAW are more attractive because they may also contain electromagnetic part. These kind of waves are bonded to the surface and they decay quickly along the depth of media.

Usually, the quasi-static approximation is utilized in analysis of SAW. This approximation allows us to neglect the magnetic part of SAW and represent the electric field using electric potential. However, in many cases, like the coupling between an electromagnetic field and a gain material in a maser, the magnetic field is the most crucial part. So

# Methodology

## Weak Form

To derive the weak form of our system, we need to know the total energy density stored in an unit volume of medium.

In this system, the total energy density has two parts: mechanical energy ($U_1$) and electromagnetic energy ($U_2$). 

The mechanical energy is constituted from elastic energy and kinetic energy, and the electromagnetic energy is constituted from electric energy and magnetic energy. So that they are represented by

Substitute the stress $T$ using the first equation in the constitutive relation, 

  

$$
2U=\underline{v}\cdot\underline{p}+\underline{\underline{S}}:\underline{\underline{T}}+\underline{E}\cdot\underline{D}+\underline{H}\cdot\underline{B}
$$

So that the weak form can be written as

$$
\int_V-\left(\tilde{\underline{v}}\cdot\underline{p}+\tilde{\underline{\underline{S}}}:\underline{\underline{T}}+\tilde{\underline{E}}\cdot\underline{D}+\tilde{\underline{H}}\cdot\underline{B}\right)=0
$$

where “~” signifies the test function of this physics quantity. In a piezoelectric material, acoustic fields and electromagnetic fields are related to each other through the constitutive relations

$$
\underline{\underline{T}}=\underline{\underline{\underline{\underline{c}}}}:\underline{\underline{S}}-\underline{\underline{e}}^T\underline{E}\\
\underline{D}=\underline{\underline{\underline{e}}}:\underline{\underline{S}}+\underline{\underline{ε}}\underline{E}
$$

When the constitutive relations are substituted, and the integrand is transformed as

$$
-\left(\tilde{\underline{v}}\cdot\underline{p}+\tilde{\underline{\underline{S}}}:(\underline{\underline{\underline{\underline{c}}}}:\underline{\underline{S}}-\underline{\underline{e}}^T\underline{E})+\tilde{\underline{E}}\cdot(\underline{\underline{\underline{e}}}:\underline{\underline{S}}+\underline{\underline{ε}}\underline{E})+\tilde{\underline{H}}\cdot\underline{B}\right)
$$

$$
\begin{aligned}
U_1&=\frac{1}{2}\underline{\underline{S}}:\underline{\underline{\underline{c}}}:\underline{\underline{S}}-\frac{1}{2}\rho\omega^2\underline{u}\cdot\underline{u}\\
&=\frac{1}{2}(\nabla_s\underline{u}):\underline{\underline{\underline{c}}}:(\nabla_s\underline{u})-\frac{1}{2}\rho\omega^2\underline{u}\cdot\underline{u}\\
\end{aligned}
$$

where $\underline{\underline{\underline{\underline{c}}}}$ is the compliance tensor,  underlines indicate the order of tensors.

The electromagnetic energy

$$
\begin{aligned}
E_2&=E_{electric}+E_{magnetic}\\
&=\underline{D}\cdot{\underline{E}}+\underline{H}\cdot{\underline{B}}
\end{aligned}
$$

$$
\begin{aligned}
U_2&=\underline{E}\cdot\underline{\underline{\epsilon}}\cdot\underline{E}+\mu_0\underline{H}\cdot\underline{H}\\
&=\underline{E}\cdot\underline{\underline{\epsilon}}\cdot\underline{E}+\mu_0(\nabla \times \underline{E})\cdot(\nabla\times\underline{E})
\end{aligned}
$$

The units of every term in the weak form should be the same, so that

Where tilde “~” symbolize the test function of a physics quantity.

The coupling terms come from the second terms in the constitutive relation.

$$
U_1=
$$

## Boundary Conditions

### Fixed Boundary

In some models, waves are evanescent. The dimension of total systems can be set to several-wavelength long and we can assume that the amplitudes on some outer boundaries are zero, and then the fixed boundary condition is used.

This boundary condition can be realized using `Dirichlet Boundary Condition` Node.

### Periodic Boundary

When analysing some models like infinitely long waveguide, periodic boundary condition is necessary. This boundary condition is applied on the surface perpendicular to the transmitting direction. For the analysis of waves on a infinitely large surface or within the medium, the waves usually have no variance on some particular directions, and the periodic boundary condition should also be applied on the surface perpendicular to that directions.

In addition, the dimension of the model is relative to periodic condition. The distance between two periodic surface is an integral multiple of the wavelength. So that the dimension will determine the wavelength of a wave, and the velocity (when the frequency is fixed).

This boundary condition can be realized using `Periodic Condition` Node.

### Free Boundary and Continuous Boundary

On the interface between a piezoelectric material and the air, the propagation of an acoustic wave stops but the propagation of an electromagnetic wave doesn’t. Thus, on such kind of interface, the free boundary condition should be applied for acoustic waves and the continuous boundary condition should be applied for electromagnetic field.

For electromagnetic fields on both side, the tangential part of $\underline{E}$ and $\underline{H}$ and the vertical part of  $\underline{D}$ and $\underline{E}$ are the same. Only one of these these conditions is enough for an interface. 

$$
(\underline{E_1}-\underline{E_2})\times\hat{n}=0\\
(\underline{H_1}-\underline{H_2})\times\hat{n}=0\\
(\underline{D_1}-\underline{D_2})\cdot\hat{n}=0\\
(\underline{B_1}-\underline{B_2})\cdot\hat{n}=0\\
$$

The free boundary condition can be realized using `Zero Flux` node, and the continuous boundary condition can be realized using `Pointwise Constraint` node.

# Plotting

The default setting of COMSOL is set the darkest colour to the location of maximum value and the lightest one for the minimum value. Since the 

The default colour bar of COMSOL depends on “local” maxima and minima of each entities, which may lead to discontinuity of colours corresponding to continuous physics quantities. To fix this problem, we need to normalize physics quantities before plotting. Global maxima of each quantities is obtained using `Maximum` function in `Definition` node. Then we set the ranges of plotting as:

# Supplementary Information

In piezoelectric material

## Mechanical Field

The definition of strain field

```
S1	comp1.ux		
S2	comp1.vy		
S3	comp1.wz		
S4	comp1.vz+comp1.wy		
S5	comp1.uz+comp1.wx		
S6	comp1.uy+comp1.vx
```

Representing the stress field using the strain field

```
T1	root.material.StressCharge.cE11*S1+root.material.StressCharge.cE12*S2+root.material.StressCharge.cE13*S3+root.material.StressCharge.cE14*S4+root.material.StressCharge.cE15*S5+root.material.StressCharge.cE16*S6	Pa	
T2	root.material.StressCharge.cE21*S1+root.material.StressCharge.cE22*S2+root.material.StressCharge.cE23*S3+root.material.StressCharge.cE24*S4+root.material.StressCharge.cE25*S5+root.material.StressCharge.cE26*S6	Pa	
T3	root.material.StressCharge.cE31*S1+root.material.StressCharge.cE32*S2+root.material.StressCharge.cE33*S3+root.material.StressCharge.cE34*S4+root.material.StressCharge.cE35*S5+root.material.StressCharge.cE36*S6	Pa	
T4	root.material.StressCharge.cE41*S1+root.material.StressCharge.cE42*S2+root.material.StressCharge.cE43*S3+root.material.StressCharge.cE44*S4+root.material.StressCharge.cE45*S5+root.material.StressCharge.cE46*S6	Pa	
T5	root.material.StressCharge.cE51*S1+root.material.StressCharge.cE52*S2+root.material.StressCharge.cE53*S3+root.material.StressCharge.cE54*S4+root.material.StressCharge.cE55*S5+root.material.StressCharge.cE56*S6	Pa	
T6	root.material.StressCharge.cE61*S1+root.material.StressCharge.cE62*S2+root.material.StressCharge.cE63*S3+root.material.StressCharge.cE64*S4+root.material.StressCharge.cE65*S5+root.material.StressCharge.cE66*S6	Pa
```

A middle quantity in coupling terms

```
eSx	root.material.StressCharge.eES11*S1+root.material.StressCharge.eES12*S2+root.material.StressCharge.eES13*S3+root.material.StressCharge.eES14*S4+root.material.StressCharge.eES15*S5+root.material.StressCharge.eES16*S6	C/m²	
eSy	root.material.StressCharge.eES21*S1+root.material.StressCharge.eES22*S2+root.material.StressCharge.eES23*S3+root.material.StressCharge.eES24*S4+root.material.StressCharge.eES25*S5+root.material.StressCharge.eES26*S6	C/m²	
eSz	root.material.StressCharge.eES31*S1+root.material.StressCharge.eES32*S2+root.material.StressCharge.eES33*S3+root.material.StressCharge.eES34*S4+root.material.StressCharge.eES35*S5+root.material.StressCharge.eES36*S6	C/m²
```

Weak form in mechanical field

```
-(test(S1)*T1+test(S2)*T2+test(S3)*T3+test(S4)*T4+test(S5)*T5+test(S6)*T6)
rho*(omega)^2*(test(u)*u+test(v)*v+test(w)*w)
test(u)*diveEx+test(v)*diveEy+test(w)*diveEz
```

## Electromagnetic Field

$$

$$